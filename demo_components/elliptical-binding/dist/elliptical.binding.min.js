!function(e,n){"undefined"!=typeof module&&module.exports?module.exports=n(require("elliptical-utils"),require("component-extensions").template,require("elliptical-mutation-summary")):"function"==typeof define&&define.amd?define(["elliptical-utils","component-extensions","elliptical-mutation-summary"],n):(e.elliptical=e.elliptical||{},e.elliptical.binding=n(e.elliptical.utils,elliptical.extensions.template,elliptical.mutation.summary),e.returnExports=e.elliptical.binding)}(this,function(e,n,t){function o(){$(document).on("OnDocumentMutation",function(e,n){n.added&&l(n.added),n.removed&&c(n.removed)})}function i(e,n){m||o(),m=!0;var t=b.obj;t.fn=n,t.context=this,g.set(e,t),this.click="touchclick",this._events=[]}function l(e){g.forEach(function(n,t){var o=$(e).selfFind("["+d+'="'+t+'"]');o[0]&&$.each(o,function(e,o){var i=s.id(8);o._EA_BINDING_ID=i;var l=_.obj;l.node=o,l.context=n.context,l.attrValue=t,l.fn=n.fn,y.set(i,l),r(n.context,o,n.fn)})})}function r(e,n,t){setTimeout(function(){t.call(e,n)},v)}function c(e){var n=$(e).selfFind(p);n.length&&n.length>0&&$.each(n,function(e,n){n._EA_BINDING_ID&&a(n)})}function a(e){var n=e._EA_BINDING_ID,t=y.get(n);void 0===t?f(e):u(t,e,n)}function u(e,n,t){e.context.unbindEvents(),e.context.onDestroy(),e.context=null,n&&n.parentNode&&n.parentNode.removeChild(n),e.fn=null,e.node=null,y["delete"](t)}function f(e){y.forEach(function(n,t){e===t.node&&u(t,e,n)})}n.template&&(n=n.template);var s=e.random,p="[ea-bind]",d="ea-bind",m=!1,v=500,h=250,g=new Map,y=new Map;t.connect();var b={get obj(){return{fn:null,context:null}}},_={get obj(){return{node:null,context:null,fn:null,attrValue:null}}};return $(function(){var e=document.querySelectorAll(p);e.length&&setTimeout(function(){l(e)},h)}),i.prototype.jsonParseMessage=function(e){try{var n=JSON.parse(e);return n.message?n.message:e}catch(t){return e}},i.prototype.render=function(e,t,o,i){n._render(e,t,o,i)},i.prototype.renderTemplate=function(e,t,o){n._renderTemplate(e,t,function(e,n){e||(n=$.parseHTML(n,document,!0)),o&&o(e,n)})},i.prototype.renderTemplateString=function(e,t,o){n._renderTemplateString(e,t,o)},i.prototype.preload=function(e,n){var t=[],o={},i=$(e),l=i.find("img"),r=l.length,c=0;return 0===r?(n&&n(null),!1):($.each(l,function(e,i){var l=new Image;$(l).bind("load",function(e){c++,t.push(l),c===r&&n&&(o.images=t,o.length=c,n(o))}),l.src=i.src}),!0)},i.prototype.load=function(e,n){var t=new Image;t.onload=function(){n(this)},t.src=e},i.prototype.component=function(e,n,t){if(e[n])return t(e[n].bind(e));var o=0,i=20,l=setInterval(function(){e[n]?(clearInterval(l),t(e[n].bind(e))):i>o?o++:(clearInterval(l),t(e[n].bind(e)))},300)},i.prototype.onDestroy=function(){},i.prototype.event=function(e,n,t,o){var i={};i.element=e,i.event=n;var l=arguments.length;3===l&&(o="function"==typeof t?t:null,t=null),i.selector=t,i.callback=o;var r=this._events;-1===$.inArray(i,r)&&this._events.push(i),t?e.on(n,t,function(){var e=[].slice.call(arguments);o&&o.apply(this,e)}):e.on(n,function(){var e=[].slice.call(arguments);o&&o.apply(this,e)})},i.prototype.unbindEvents=function(){for(var e=this._events,n=e.length,t=0;n>t;t++){var o=e[t];o.selector?o.element.off(o.event,o.selector):o.element.off(o.event)}e.length=0},function(e,n){return new i(e,n)}});